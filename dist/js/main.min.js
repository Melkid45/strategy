window.addEventListener("load",(function(){setTimeout((function(){ScrollTrigger.refresh(!0),console.log("ScrollTrigger refreshed")}),2e3)})),window.addEventListener("resize",(function(){setTimeout((function(){ScrollTrigger.refresh(!0)}),500)})),ScrollTrigger.normalizeScroll(!0),gsap.ticker.lagSmoothing(0),ScrollTrigger.config({limitCallbacks:!0,ignoreMobileResize:!0,autoRefreshEvents:"visibilitychange,DOMContentLoaded,load"});const lenis=new Lenis({duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e)),smoothWheel:!0,smoothTouch:!1,touchMultiplier:2,infinite:!1,autoRaf:!1});function raf(e){lenis.raf(e),requestAnimationFrame(raf)}requestAnimationFrame(raf);class ScrollManager{constructor(){this.isLenisAvailable=!1,this.init()}init(){this.checkLenis(),window.addEventListener("load",(()=>{this.scrollToTop()}))}checkLenis(){return!(void 0===lenis||!lenis.scrollTo)&&(this.isLenisAvailable=!0,!0)}scrollToTop(){if(this.checkLenis())try{ScrollTrigger.getAll().forEach((e=>e.disable())),lenis.scrollTo(0,{immediate:!0,lock:!1,onComplete:()=>{this.enableScrollTriggers()}}),setTimeout((()=>{lenis.scroll>10&&lenis.scrollTo(0,{immediate:!0,onComplete:()=>this.enableScrollTriggers()})}),100)}catch(e){console.warn("Lenis scroll failed, using native scroll"),window.scrollTo(0,0),this.enableScrollTriggers()}else window.scrollTo(0,0),this.enableScrollTriggers()}enableScrollTriggers(){setTimeout((()=>{ScrollTrigger.getAll().forEach((e=>e.enable())),ScrollTrigger.refresh()}),50)}}new ScrollManager;let lastScrollTop=0,isScrollingDown=!1;const scrollThreshold=5,activationThreshold=50;lenis.on("scroll",(({scroll:e})=>{ScrollTrigger.update(),currentScroll=e;const t=document.querySelector(".header");Math.abs(currentScroll-lastScrollTop)>5&&(isScrollingDown=currentScroll>lastScrollTop,lastScrollTop=currentScroll),isScrollingDown&&currentScroll>50?t.classList.add("back"):t.classList.remove("back")}));let archorTime=!1;function updateScroll(){gsap.delayedCall(.1,(()=>{ScrollTrigger.refresh(),void 0!==lenis&&("function"==typeof lenis.resize&&lenis.resize(),lenis.scrollTo(lenis.scroll,{immediate:!0})),window.dispatchEvent(new Event("resize"))}))}function updateMarqueeAnimation(e,t){if(!e||!e.firstElementChild)return;const i=e.firstElementChild.scrollWidth,s=e.offsetWidth,n=-(i+(parseFloat(getComputedStyle(e).gap)||0))/s*100,o=`dynamic-marquee-${t}`;let a=document.getElementById(o);a||(a=document.createElement("style"),a.id=o,document.head.appendChild(a)),a.innerHTML=`\n    @keyframes animPartners-${t} {\n      0% { \n        transform: translateX(0);\n        opacity: 1;\n      }\n      95% {\n        opacity: 1;\n      }\n      100% { \n        transform: translateX(${n}%);\n        opacity: 1;\n      }\n    }\n\n    .marquee-${t} {\n      animation: animPartners-${t} 15s linear infinite;\n      animation-fill-mode: both;\n    }\n  `,e.classList.add(`marquee-${t}`),e.style.animation="none",setTimeout((()=>{e.style.animation=""}),10)}function initMarquees(){const e=document.querySelectorAll([".stoke-title .stroke-wrap",".agency-stroke",".longest__body .stroke-wrap",".case-frame .item .item-stroke-wrap",".footer-stroke"].join(", "));let t;e.forEach(((e,t)=>{updateMarqueeAnimation(e,t),e.addEventListener("animationiteration",(function(){this.style.opacity="1"}))})),window.addEventListener("resize",(function(){clearTimeout(t),t=setTimeout((()=>{e.forEach(((e,t)=>updateMarqueeAnimation(e,t)))}),250)}))}function splitLetters(){document.querySelectorAll(".split-light, .split-dark").forEach((e=>{e.querySelectorAll("span").forEach((e=>{const t=e.textContent.split("");e.innerHTML=t.map((e=>`<span class="char">${e}</span>`)).join("")}))}))}window.addEventListener("load",(()=>{ScrollTrigger.refresh(),lenis.scrollTo(0),lenis.emit(),lenis.resize(),lenis.raf(0),setTimeout((()=>{document.querySelectorAll('a[href^="#"]').forEach((e=>{e.addEventListener("click",(t=>{archorTime=!0,setTimeout((()=>{archorTime=!1}),1e3),t.preventDefault();const i=document.querySelector(e.getAttribute("href"));let s=i.parentNode;if(console.log(s),s.classList.contains("pin-spacer")){const e=s.previousElementSibling,t=e.clientHeight;lenis.scrollTo(e.offsetTop+t,{lerp:.1,duration:2.5})}else lenis.scrollTo(i,{lerp:.1,duration:2.5})}))}))}),500)})),window.addEventListener("resize load",(()=>controller.update(!0))),window.addEventListener("hashchange",(()=>{ScrollTrigger.refresh()})),$(".services-frame .item").on("click",(function(){$(this).hasClass("open")?($(this).removeClass("open"),$(this).next(".item").addClass("open")):($(".services-frame .item").not(this).removeClass("open"),$(this).addClass("open")),updateScroll()})),$(".faq-frame .item").on("click",(function(){$(this).hasClass("open")?($(this).removeClass("open"),$(this).next(".item").addClass("open")):($(".faq-frame .item").not(this).removeClass("open"),$(this).addClass("open")),updateScroll()})),document.addEventListener("DOMContentLoaded",(function(){setTimeout(initMarquees,500),initMarquees()})),document.addEventListener("DOMContentLoaded",(()=>{splitLetters();let e="#BEBFC3",t="#8F919A";document.querySelectorAll(".split-light, .split-dark").forEach((i=>{const s=i.querySelectorAll(".char");let n=i.classList.contains("split-light")?e:t;gsap.fromTo(s,{color:n},{color:"#fff",ease:"none",stagger:.05,scrollTrigger:{trigger:i,start:"top 80%",end:"bottom 40%",scrub:!0}})}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".item-rotate");if(!e.length)return;window.addEventListener("mousemove",(t=>{const i=window.innerWidth/2,s=15*((t.clientX-i)/i);e.forEach((e=>{gsap.to(e,{rotate:s,duration:.5,ease:"power3.out"})}))})),window.addEventListener("mouseleave",(()=>{e.forEach((e=>{gsap.to(e,{rotate:0,duration:1,ease:"power3.out"})}))}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("pupil"),t=e.closest("svg");if(!e||!t)return;window.addEventListener("mousemove",(i=>{const s=t.getBoundingClientRect(),n=s.left+s.width/2,o=s.top+s.height/2,a=i.clientX-n,r=i.clientY-o,c=Math.atan2(r,a),l=Math.min(8,Math.hypot(a,r)),h=60+Math.cos(c)*l,d=60+Math.sin(c)*l;gsap.to(e,{attr:{cx:h,cy:d},duration:.2,ease:"power2.out"})})),window.addEventListener("mouseleave",(()=>{gsap.to(e,{attr:{cx:60,cy:60},duration:.3,ease:"power2.out"})}))}));class DotCanvas{constructor(e){this.canvas=e,this.ctx=e.getContext("2d"),this.w=this.canvas.width=this.canvas.offsetWidth,this.h=this.canvas.height=this.canvas.offsetHeight,this.spacing=48,this.dots=[],this.initDots(),this.cursor={x:this.w/2,y:this.h/2,tx:this.w/2,ty:this.h/2,vx:0,vy:0,speed:0},this.setupEventListeners(),this.animate()}initDots(){for(let e=this.spacing/2;e<this.h;e+=this.spacing)for(let t=this.spacing/2;t<this.w;t+=this.spacing)this.dots.push({x:t,y:e,r:2,targetR:2,opacity:.5,targetOpacity:.5})}setupEventListeners(){this.handleMouseMove=e=>{const t=this.canvas.getBoundingClientRect();e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom&&(this.cursor.tx=e.clientX-t.left,this.cursor.ty=e.clientY-t.top)},window.addEventListener("mousemove",this.handleMouseMove),this.handleResize=()=>{this.w=this.canvas.width=this.canvas.offsetWidth,this.h=this.canvas.height=this.canvas.offsetHeight,this.dots=[],this.initDots()},window.addEventListener("resize",this.handleResize)}draw(){this.ctx.clearRect(0,0,this.w,this.h);let e=this.cursor.tx-this.cursor.x,t=this.cursor.ty-this.cursor.y;this.cursor.vx+=.2*e,this.cursor.vy+=.2*t,this.cursor.vx*=.7,this.cursor.vy*=.7,this.cursor.x+=this.cursor.vx,this.cursor.y+=this.cursor.vy,this.cursor.speed=Math.sqrt(this.cursor.vx*this.cursor.vx+this.cursor.vy*this.cursor.vy),this.dots.forEach((e=>{const t=Math.hypot(e.x-this.cursor.x,e.y-this.cursor.y);t<120?(e.targetR=1+(120-t)/50,e.targetOpacity=.5):(e.targetR=.5,e.targetOpacity=0),e.r+=.1*(e.targetR-e.r),e.opacity+=.1*(e.targetOpacity-e.opacity),this.ctx.beginPath(),this.ctx.arc(e.x,e.y,e.r,0,2*Math.PI),this.ctx.fillStyle=`rgba(255, 255, 255, ${e.opacity})`,this.ctx.fill()}))}animate(){this.draw(),requestAnimationFrame((()=>this.animate()))}destroy(){window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("resize",this.handleResize)}}class DotCanvasManager{constructor(){this.canvases=new Map,this.init()}init(){document.querySelectorAll("#dotCanvas, .dotCanvas, canvas[data-dot-canvas]").forEach(((e,t)=>{e.id||(e.id=`dotCanvas-${t}`);const i=new DotCanvas(e);this.canvases.set(e.id,i)}))}getCanvas(e){return this.canvases.get(e)}destroy(){this.canvases.forEach((e=>e.destroy())),this.canvases.clear()}}function addDotCanvas(e){window.dotCanvasManager||(window.dotCanvasManager=new DotCanvasManager);const t=new DotCanvas(e);return window.dotCanvasManager.canvases.set(e.id||`dotCanvas-${Date.now()}`,t),t}document.addEventListener("DOMContentLoaded",(()=>{window.dotCanvasManager=new DotCanvasManager}));const lines=document.querySelectorAll(".line path"),lineAnimations=new Map;function updateLinePath(e,t,i){const s=100,n=500,o=Math.max(0,Math.min(2e3,i)),a=[{x:0,y:s},{x:o-250,y:s},{x:o,y:s+t},{x:o+250,y:s},{x:2e3,y:s}];let r=`M${a[0].x} ${a[0].y}`;r+=` L${a[1].x} ${a[1].y}`,r+=` C${a[1].x+125} ${a[1].y}, \n           ${a[2].x-n/6} ${a[2].y}, \n           ${a[2].x} ${a[2].y}`,r+=` C${a[2].x+n/6} ${a[2].y}, \n           ${a[3].x-125} ${a[3].y}, \n           ${a[3].x} ${a[3].y}`,r+=` L${a[4].x} ${a[4].y}`,e.setAttribute("d",r)}lines.forEach((e=>{lineAnimations.set(e,{depth:0,x:1e3,tween:null})})),document.addEventListener("mousemove",(e=>{lines.forEach((t=>{const i=lineAnimations.get(t),s=t.closest("svg").getBoundingClientRect(),n=s.top+s.height/2,o=Math.abs(e.clientY-n),a=o<80,r=1-Math.pow(o/80,1.5),c=a?Math.max(-80,Math.min(80,(n-e.clientY)*r*2.5)):0,l=2e3/s.width,h=(e.clientX-s.left)*l;i.tween&&i.tween.kill(),i.tween=gsap.to(i,{duration:.4,depth:c,x:h,ease:"power2.out",onUpdate:()=>{updateLinePath(t,i.depth,i.x)}})}))})),document.addEventListener("mouseleave",(()=>{lines.forEach((e=>{const t=lineAnimations.get(e);t.tween&&t.tween.kill(),t.tween=gsap.to(t,{duration:.8,depth:0,x:1e3,ease:"elastic.out(1, 0.4)",onUpdate:()=>{updateLinePath(e,t.depth,t.x)}})}))})),gsap.to(".hero-block .circle-hero",{scale:15,yPercent:-50,xPercent:-70,scrollTrigger:{trigger:".hero-block",start:"top top",end:"+=50%",scrub:1,pin:!0,pinSpacing:!1}});let xcodeItemWidth,xcodeGap,formula,xcodeContainer=document.querySelector(".xcode-cards"),xcodeItems=gsap.utils.toArray(".xcode-cards .item");function updateXcodeMetrics(){xcodeItemWidth=xcodeItems[0].offsetWidth,xcodeGap=parseFloat(getComputedStyle(xcodeContainer).gap)||0,formula=(xcodeItemWidth+xcodeGap)*(xcodeItems.length-1)}updateXcodeMetrics();const tl=gsap.timeline({scrollTrigger:{trigger:".xcode",start:"top+=40%",end:()=>`+=${formula}`,pin:!0,scrub:1,onUpdate:e=>{const t=e.progress;setActive(Math.min(xcodeItems.length-1,Math.floor(t*xcodeItems.length)))}}});function setActive(e){xcodeContainer.dataset.activeIndex&&xcodeContainer.dataset.activeIndex==e||(xcodeItems.forEach((e=>e.classList.remove("active"))),xcodeItems[e].classList.add("active"),xcodeContainer.dataset.activeIndex=e)}tl.to(".xcode-cards",{x:-formula,ease:"none"}),window.addEventListener("resize",(()=>{updateXcodeMetrics(),ScrollTrigger.refresh()})),gsap.to(".guarantees-circle",{yPercent:-60,scale:16,ease:"power1.inOut",rotate:90,scrollTrigger:{trigger:".guarantees",start:"+=45%",end:"+=200%",scrub:1,pin:!0,pinSpacing:!1}}),gsap.to(".implementation .circle-hero",{scale:15,yPercent:-50,xPercent:-70,scrollTrigger:{trigger:".implementation",start:"top top",end:"+=75%",scrub:1,pin:!0,pinSpacing:!1}}),gsap.set(".feedback-form, .guarantees-section",{yPercent:-85,scale:.3,xPercent:-35}),gsap.to(".guarantees-section",{yPercent:0,xPercent:0,scale:1,ease:"power1.inOut",scrollTrigger:{trigger:".guarantees__wrap",start:"top center",end:"+=70%",scrub:1}}),gsap.to(".feedback-form",{yPercent:0,xPercent:0,scale:1,ease:"power1.inOut",scrollTrigger:{trigger:".feedback-wrap",start:"top center",end:"+=70%",scrub:1}});class AgencyTrail{constructor(e){this.agency=e,this.animationContainer=this.agency.querySelector(".wrap-agency-animation"),this.animationContainer?(this.isValid=!0,this.content=this.animationContainer.querySelector(".content"),this.content||(this.content=this.agency.querySelector(".content")),this.images=Array.from(this.content.querySelectorAll(".content__img")),this.imgInners=Array.from(this.content.querySelectorAll(".content__img-inner")),this.mouse={x:0,y:0},this.lastMouse={x:0,y:0},this.cacheMouse={x:0,y:0},this.zIndex=1,this.activeIndex=0,this.activeImagesCount=0,this.isIdle=!0,this.isPaused=!1,this.activationDistance=80,this.animationRect=this.animationContainer.getBoundingClientRect(),this.activeAnimations=new Map,this.hideAnimation=null,this.init()):this.isValid=!1}init(){this.isValid&&(this.hideAllImages(),this.setupEventListeners(),this.startTracking())}setupEventListeners(){this.isValid&&(this.animationContainer.addEventListener("mousemove",(e=>{this.updateAnimationRect(),this.mouse.x=e.clientX-this.animationRect.left,this.mouse.y=e.clientY-this.animationRect.top})),this.animationContainer.addEventListener("mouseenter",(e=>{this.isPaused=!1,this.updateAnimationRect(),this.mouse.x=e.clientX-this.animationRect.left,this.mouse.y=e.clientY-this.animationRect.top,this.cacheMouse.x=this.mouse.x,this.cacheMouse.y=this.mouse.y,this.lastMouse.x=this.mouse.x,this.lastMouse.y=this.mouse.y,this.hideAnimation&&(this.hideAnimation.kill(),this.hideAnimation=null)})),this.animationContainer.addEventListener("mouseleave",(e=>{this.isCursorInAnimationContainer(e)||(this.isPaused=!0,this.hideAllImagesSmoothly())})),document.addEventListener("mousemove",(e=>{this.isPaused&&this.isCursorInAnimationContainer(e)&&(this.isPaused=!1,this.hideAnimation&&(this.hideAnimation.kill(),this.hideAnimation=null),this.updateAnimationRect(),this.mouse.x=e.clientX-this.animationRect.left,this.mouse.y=e.clientY-this.animationRect.top,this.cacheMouse.x=this.mouse.x,this.cacheMouse.y=this.mouse.y,this.lastMouse.x=this.mouse.x,this.lastMouse.y=this.mouse.y)})),window.addEventListener("resize",(()=>{this.updateAnimationRect()})))}isCursorInAnimationContainer(e){const t=this.animationContainer.getBoundingClientRect();return e.clientX>=t.left-2&&e.clientX<=t.right+2&&e.clientY>=t.top-2&&e.clientY<=t.bottom+2}updateAnimationRect(){this.animationRect=this.animationContainer.getBoundingClientRect()}startTracking(){this.isValid&&gsap.ticker.add((()=>{this.isPaused||(this.cacheMouse.x=this.lerp(this.cacheMouse.x,this.mouse.x,.1),this.cacheMouse.y=this.lerp(this.cacheMouse.y,this.mouse.y,.1),this.checkDistanceAndSpawn())}))}lerp(e,t,i){return e+(t-e)*i}getDistance(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}checkDistanceAndSpawn(){this.getDistance(this.lastMouse,this.mouse)>this.activationDistance&&(this.spawnImage(),this.lastMouse={...this.mouse}),this.isIdle&&1!==this.zIndex&&(this.zIndex=1)}spawnImage(){if(this.isPaused||!this.isValid)return;this.activeImagesCount++,this.isIdle=!1,this.zIndex++,this.activeIndex=this.activeIndex<this.images.length-1?this.activeIndex+1:0;const e=this.images[this.activeIndex],t=this.imgInners[this.activeIndex];this.activeAnimations.has(e)&&this.activeAnimations.get(e).kill();const i=e.getBoundingClientRect();gsap.set(e,{x:this.mouse.x-i.width/2,y:this.mouse.y-i.height/2,scale:0,opacity:1,zIndex:this.zIndex}),gsap.set(t,{scale:2.8,filter:"brightness(150%)"});const s=gsap.timeline({onStart:()=>this.onImageActivate(),onComplete:()=>{this.onImageComplete(),this.activeAnimations.delete(e)}});this.activeAnimations.set(e,s),s.to(e,{duration:.4,ease:"power1.out",scale:1},0).to(t,{duration:.6,ease:"power1.out",scale:1,filter:"brightness(100%)"},0).to(e,{duration:.4,ease:"power2.in",opacity:0,scale:.2},.45)}hideAllImages(){this.isValid&&(this.images.forEach((e=>{gsap.set(e,{opacity:0,scale:.2})})),this.activeAnimations.forEach(((e,t)=>{e.kill()})),this.activeAnimations.clear(),this.hideAnimation&&(this.hideAnimation.kill(),this.hideAnimation=null),this.activeImagesCount=0,this.isIdle=!0,this.zIndex=1)}hideAllImagesSmoothly(){if(!this.isValid)return;this.activeAnimations.forEach(((e,t)=>{e.kill()})),this.activeAnimations.clear(),this.hideAnimation&&this.hideAnimation.kill();const e=this.images.filter((e=>gsap.getProperty(e,"opacity")>0));if(0===e.length)return this.activeImagesCount=0,void(this.isIdle=!0);this.hideAnimation=gsap.timeline({onComplete:()=>{this.activeImagesCount=0,this.isIdle=!0,this.zIndex=1,this.hideAnimation=null}}),e.forEach((e=>{const t=gsap.getProperty(e,"scale");gsap.getProperty(e,"opacity");this.hideAnimation.to(e,{duration:.3,ease:"power2.out",opacity:0,scale:.5*t,overwrite:!0},0)}))}onImageActivate(){this.activeImagesCount++}onImageComplete(){this.activeImagesCount--,0===this.activeImagesCount&&(this.isIdle=!0)}}class AgencyTrailManager{constructor(){this.agencyTrails=[],this.init()}init(){document.querySelectorAll(".agency").forEach((e=>{if(e.querySelector(".wrap-agency-animation")){const t=new AgencyTrail(e);t.isValid&&this.agencyTrails.push(t)}}))}}function autoResize(e){e.style.height="auto",e.style.height=e.scrollHeight+"px"}document.addEventListener("DOMContentLoaded",(()=>{new AgencyTrailManager})),gsap.to(".hero-block .stoke-title",{opacity:0,scrollTrigger:{trigger:".hero-block__body",start:"top top",end:"+=10%",scrub:1}}),gsap.to(".implementation .stoke-title",{opacity:0,scrollTrigger:{trigger:".implementation__body",start:"top top",end:"+=10%",scrub:1}});const textarea=document.querySelector("textarea");autoResize(textarea),textarea.addEventListener("input",(()=>autoResize(textarea))),function(){const e=.15,t={x:window.innerWidth/2,y:window.innerHeight/2,prevX:window.innerWidth/2,prevY:window.innerHeight/2,speed:0},i=document.getElementById("cursorTrail"),s=[],n=document.createElement("div");n.className="cursor-dot center",i.appendChild(n),s.push({el:n,x:t.x,y:t.y,scale:1,opacity:1});for(let e=0;e<10;e++){const e=document.createElement("div");e.className="cursor-dot tail",i.appendChild(e),s.push({el:e,x:t.x,y:t.y,scale:1,opacity:0})}function o(e){const i=e.clientX||e.touches&&e.touches[0].clientX||t.x,s=e.clientY||e.touches&&e.touches[0].clientY||t.y;t.speed=Math.hypot(i-t.prevX,s-t.prevY),t.prevX=t.x,t.prevY=t.y,t.x=i,t.y=s}function a(e,t,i){return e+(t-e)*i}window.addEventListener("pointermove",o,{passive:!0}),window.addEventListener("touchmove",o,{passive:!0}),function e(){t.speed*=.85,requestAnimationFrame(e)}(),requestAnimationFrame((function i(){s[0].x=a(s[0].x,t.x,1.5*e),s[0].y=a(s[0].y,t.y,1.5*e),s[0].el.style.transform=`translate3d(${s[0].x}px, ${s[0].y}px,0) translate(-50%, -50%) scale(1)`;const n=t.speed>1.5;for(let i=1;i<s.length;i++){const o=s[i-1],r=s[i];r.x=a(r.x,o.x,e+.015*i),r.y=a(r.y,o.y,e+.015*i);let c=1;if(n){c+=Math.min(t.speed/25,1)*(1-i/s.length)*1.6}r.scale=a(r.scale,c,.08),r.el.style.transform=`translate3d(${r.x}px, ${r.y}px,0) translate(-50%, -50%) scale(${r.scale})`;const l=t.speed<.1?0:.2*(1-i/s.length);r.opacity=a(r.opacity,l,.1),r.el.style.opacity=r.opacity.toFixed(1)}requestAnimationFrame(i)}))}();
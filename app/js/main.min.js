window.addEventListener("load",(function(){setTimeout((function(){ScrollTrigger.refresh(!0),console.log("ScrollTrigger refreshed")}),2e3)})),window.addEventListener("resize",(function(){setTimeout((function(){ScrollTrigger.refresh(!0)}),500)})),ScrollTrigger.normalizeScroll(!0),gsap.ticker.lagSmoothing(0),ScrollTrigger.config({limitCallbacks:!0,ignoreMobileResize:!0,autoRefreshEvents:"visibilitychange,DOMContentLoaded,load"});const lenis=new Lenis({duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e)),smoothWheel:!0,smoothTouch:!1,touchMultiplier:2,infinite:!1,autoRaf:!1});function raf(e){lenis.raf(e),requestAnimationFrame(raf)}requestAnimationFrame(raf);class ScrollManager{constructor(){this.isLenisAvailable=!1,this.init()}init(){this.checkLenis(),window.addEventListener("load",(()=>{this.scrollToTop()}))}checkLenis(){return!(void 0===lenis||!lenis.scrollTo)&&(this.isLenisAvailable=!0,!0)}scrollToTop(){if(this.checkLenis())try{ScrollTrigger.getAll().forEach((e=>e.disable())),lenis.scrollTo(0,{immediate:!0,lock:!1,onComplete:()=>{this.enableScrollTriggers()}}),setTimeout((()=>{lenis.scroll>10&&lenis.scrollTo(0,{immediate:!0,onComplete:()=>this.enableScrollTriggers()})}),100)}catch(e){console.warn("Lenis scroll failed, using native scroll"),window.scrollTo(0,0),this.enableScrollTriggers()}else window.scrollTo(0,0),this.enableScrollTriggers()}enableScrollTriggers(){setTimeout((()=>{ScrollTrigger.getAll().forEach((e=>e.enable())),ScrollTrigger.refresh()}),50)}}new ScrollManager;let lastScrollTop=0,isScrollingDown=!1;const scrollThreshold=5,activationThreshold=50;lenis.on("scroll",(({scroll:e})=>{ScrollTrigger.update(),currentScroll=e;const t=document.querySelector(".header");Math.abs(currentScroll-lastScrollTop)>5&&(isScrollingDown=currentScroll>lastScrollTop,lastScrollTop=currentScroll),isScrollingDown&&currentScroll>50?t.classList.add("back"):t.classList.remove("back")}));let archorTime=!1;function updateMarqueeAnimation(e,t){if(!e||!e.firstElementChild)return;const s=e.firstElementChild.scrollWidth,n=e.offsetWidth,i=-(s+(parseFloat(getComputedStyle(e).gap)||0))/n*100,o=`dynamic-marquee-${t}`;let r=document.getElementById(o);r||(r=document.createElement("style"),r.id=o,document.head.appendChild(r)),r.innerHTML=`\n    @keyframes animPartners-${t} {\n      0% { \n        transform: translateX(0);\n        opacity: 1;\n      }\n      95% {\n        opacity: 1;\n      }\n      100% { \n        transform: translateX(${i}%);\n        opacity: 1;\n      }\n    }\n\n    .marquee-${t} {\n      animation: animPartners-${t} 15s linear infinite;\n      animation-fill-mode: both;\n    }\n  `,e.classList.add(`marquee-${t}`),e.style.animation="none",setTimeout((()=>{e.style.animation=""}),10)}function initMarquees(){const e=document.querySelectorAll([".stoke-title .stroke-wrap",".agency-stroke",".longest__body .stroke-wrap",".case-frame .item .item-stroke-wrap",".footer-stroke"].join(", "));let t;e.forEach(((e,t)=>{updateMarqueeAnimation(e,t),e.addEventListener("animationiteration",(function(){this.style.opacity="1"}))})),window.addEventListener("resize",(function(){clearTimeout(t),t=setTimeout((()=>{e.forEach(((e,t)=>updateMarqueeAnimation(e,t)))}),250)}))}function splitLetters(){document.querySelectorAll(".split-light, .split-dark").forEach((e=>{e.querySelectorAll("span").forEach((e=>{const t=e.textContent.split("");e.innerHTML=t.map((e=>`<span class="char">${e}</span>`)).join("")}))}))}window.addEventListener("load",(()=>{ScrollTrigger.refresh(),lenis.scrollTo(0),lenis.emit(),lenis.resize(),lenis.raf(0),setTimeout((()=>{document.querySelectorAll('a[href^="#"]').forEach((e=>{e.addEventListener("click",(t=>{archorTime=!0,setTimeout((()=>{archorTime=!1}),1e3),t.preventDefault();const s=document.querySelector(e.getAttribute("href"));let n=s.parentNode;if(console.log(n),n.classList.contains("pin-spacer")){const e=n.previousElementSibling,t=e.clientHeight;lenis.scrollTo(e.offsetTop+t,{lerp:.1,duration:2.5})}else lenis.scrollTo(s,{lerp:.1,duration:2.5})}))}))}),500)})),window.addEventListener("resize load",(()=>controller.update(!0))),window.addEventListener("hashchange",(()=>{ScrollTrigger.refresh()})),$(".services-frame .item").on("click",(function(e){$(".services-frame .item").not(this).removeClass("open"),setTimeout((()=>{$(this).addClass("open")}),200)})),$(".faq-frame .item").on("click",(function(e){$(".faq-frame .item").not(this).removeClass("open"),setTimeout((()=>{$(this).addClass("open")}),200)})),document.addEventListener("DOMContentLoaded",(function(){setTimeout(initMarquees,500),initMarquees()})),document.addEventListener("DOMContentLoaded",(()=>{splitLetters();let e="#BEBFC3",t="#8F919A";document.querySelectorAll(".split-light, .split-dark").forEach((s=>{const n=s.querySelectorAll(".char");let i=s.classList.contains("split-light")?e:t;gsap.fromTo(n,{color:i},{color:"#fff",ease:"none",stagger:.05,scrollTrigger:{trigger:s,start:"top 80%",end:"bottom 20%",scrub:!0}})}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".item-rotate");if(!e.length)return;window.addEventListener("mousemove",(t=>{const s=window.innerWidth/2,n=15*((t.clientX-s)/s);e.forEach((e=>{gsap.to(e,{rotate:n,duration:.5,ease:"power3.out"})}))})),window.addEventListener("mouseleave",(()=>{e.forEach((e=>{gsap.to(e,{rotate:0,duration:1,ease:"power3.out"})}))}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("pupil"),t=e.closest("svg");if(!e||!t)return;window.addEventListener("mousemove",(s=>{const n=t.getBoundingClientRect(),i=n.left+n.width/2,o=n.top+n.height/2,r=s.clientX-i,a=s.clientY-o,c=Math.atan2(a,r),l=Math.min(8,Math.hypot(r,a)),h=60+Math.cos(c)*l,d=60+Math.sin(c)*l;gsap.to(e,{attr:{cx:h,cy:d},duration:.2,ease:"power2.out"})})),window.addEventListener("mouseleave",(()=>{gsap.to(e,{attr:{cx:60,cy:60},duration:.3,ease:"power2.out"})}))}));const canvas=document.getElementById("dotCanvas"),ctx=canvas.getContext("2d");let w=canvas.width=window.innerWidth,h=canvas.height=window.innerHeight;const spacing=48,dots=[];for(let e=24;e<h;e+=48)for(let t=24;t<w;t+=48)dots.push({x:t,y:e,r:2,targetR:2,opacity:.5,targetOpacity:.5});const cursor={x:w/2,y:h/2,tx:w/2,ty:h/2,vx:0,vy:0,speed:0};function draw(){ctx.clearRect(0,0,w,h);let e=cursor.tx-cursor.x,t=cursor.ty-cursor.y;cursor.vx+=.2*e,cursor.vy+=.2*t,cursor.vx*=.7,cursor.vy*=.7,cursor.x+=cursor.vx,cursor.y+=cursor.vy,cursor.speed=Math.sqrt(cursor.vx*cursor.vx+cursor.vy*cursor.vy),dots.forEach((e=>{const t=Math.hypot(e.x-cursor.x,e.y-cursor.y);t<120?(e.targetR=1+(120-t)/50,e.targetOpacity=.5):(e.targetR=.5,e.targetOpacity=0),e.r+=.1*(e.targetR-e.r),e.opacity+=.1*(e.targetOpacity-e.opacity),ctx.beginPath(),ctx.arc(e.x,e.y,e.r,0,2*Math.PI),ctx.fillStyle=`rgba(255,255,255,${e.opacity})`,ctx.fill()})),requestAnimationFrame(draw)}window.addEventListener("mousemove",(e=>{cursor.tx=e.clientX,cursor.ty=e.clientY})),draw(),window.addEventListener("resize",(()=>{w=canvas.width=window.innerWidth,h=canvas.height=window.innerHeight}));const lines=document.querySelectorAll(".line path"),lineAnimations=new Map;function updateLinePath(e,t,s){const n=100,i=500,o=Math.max(0,Math.min(2e3,s)),r=[{x:0,y:n},{x:o-250,y:n},{x:o,y:n+t},{x:o+250,y:n},{x:2e3,y:n}];let a=`M${r[0].x} ${r[0].y}`;a+=` L${r[1].x} ${r[1].y}`,a+=` C${r[1].x+125} ${r[1].y}, \n           ${r[2].x-i/6} ${r[2].y}, \n           ${r[2].x} ${r[2].y}`,a+=` C${r[2].x+i/6} ${r[2].y}, \n           ${r[3].x-125} ${r[3].y}, \n           ${r[3].x} ${r[3].y}`,a+=` L${r[4].x} ${r[4].y}`,e.setAttribute("d",a)}lines.forEach((e=>{lineAnimations.set(e,{depth:0,x:1e3,tween:null})})),document.addEventListener("mousemove",(e=>{lines.forEach((t=>{const s=lineAnimations.get(t),n=t.closest("svg").getBoundingClientRect(),i=n.top+n.height/2,o=Math.abs(e.clientY-i),r=o<80,a=1-Math.pow(o/80,1.5),c=r?Math.max(-80,Math.min(80,(i-e.clientY)*a*2.5)):0,l=2e3/n.width,h=(e.clientX-n.left)*l;s.tween&&s.tween.kill(),s.tween=gsap.to(s,{duration:.4,depth:c,x:h,ease:"power2.out",onUpdate:()=>{updateLinePath(t,s.depth,s.x)}})}))})),document.addEventListener("mouseleave",(()=>{lines.forEach((e=>{const t=lineAnimations.get(e);t.tween&&t.tween.kill(),t.tween=gsap.to(t,{duration:.8,depth:0,x:1e3,ease:"elastic.out(1, 0.4)",onUpdate:()=>{updateLinePath(e,t.depth,t.x)}})}))})),gsap.to(".guarantees-circle",{yPercent:-40,scale:16,ease:"power1.inOut",rotate:90,scrollTrigger:{trigger:".guarantees",start:"+=70%",end:"+=200%",scrub:1,pin:!0,pinSpacing:!0}}),gsap.set(".feedback-form, .guarantees-section",{yPercent:-85,scale:.3,xPercent:-35}),gsap.to(".guarantees-section",{yPercent:0,xPercent:0,scale:1,ease:"power1.inOut",scrollTrigger:{trigger:".guarantees__wrap",start:"top center",end:"+=70%",scrub:1}}),gsap.to(".feedback-form",{yPercent:0,xPercent:0,scale:1,ease:"power1.inOut",scrollTrigger:{trigger:".feedback-wrap",start:"top center",end:"+=70%",scrub:1}});class AgencyTrail{constructor(e){this.agency=e,this.content=this.agency.querySelector(".content"),this.images=Array.from(this.content.querySelectorAll(".content__img")),this.imgInners=Array.from(this.content.querySelectorAll(".content__img-inner")),this.mouse={x:0,y:0},this.lastMouse={x:0,y:0},this.cacheMouse={x:0,y:0},this.zIndex=1,this.activeIndex=0,this.activeImagesCount=0,this.isIdle=!0,this.isPaused=!1,this.activationDistance=80,this.agencyRect=this.agency.getBoundingClientRect(),this.init()}init(){this.hideAllImages(),this.setupEventListeners(),this.startTracking()}setupEventListeners(){this.agency.addEventListener("mousemove",(e=>{this.updateAgencyRect(),this.mouse.x=e.clientX-this.agencyRect.left,this.mouse.y=e.clientY-this.agencyRect.top})),this.agency.addEventListener("mouseenter",(e=>{this.isPaused=!1,this.updateAgencyRect(),this.mouse.x=e.clientX-this.agencyRect.left,this.mouse.y=e.clientY-this.agencyRect.top,this.cacheMouse.x=this.mouse.x,this.cacheMouse.y=this.mouse.y,this.lastMouse.x=this.mouse.x,this.lastMouse.y=this.mouse.y})),this.agency.addEventListener("mouseleave",(()=>{this.isPaused=!0,this.hideAllImages()})),this.agency.querySelectorAll("a, button, [data-no-hover]").forEach((e=>{e.addEventListener("mouseenter",(()=>this.isPaused=!0)),e.addEventListener("mouseleave",(()=>this.isPaused=!1))})),window.addEventListener("resize",(()=>{this.updateAgencyRect()}))}updateAgencyRect(){this.agencyRect=this.agency.getBoundingClientRect()}startTracking(){gsap.ticker.add((()=>{this.isPaused||(this.cacheMouse.x=this.lerp(this.cacheMouse.x,this.mouse.x,.1),this.cacheMouse.y=this.lerp(this.cacheMouse.y,this.mouse.y,.1),this.checkDistanceAndSpawn())}))}lerp(e,t,s){return e+(t-e)*s}getDistance(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}checkDistanceAndSpawn(){this.getDistance(this.lastMouse,this.mouse)>this.activationDistance&&(this.spawnImage(),this.lastMouse={...this.mouse}),this.isIdle&&1!==this.zIndex&&(this.zIndex=1)}spawnImage(){if(this.isPaused)return;this.activeImagesCount++,this.isIdle=!1,this.zIndex++,this.activeIndex=this.activeIndex<this.images.length-1?this.activeIndex+1:0;const e=this.images[this.activeIndex],t=this.imgInners[this.activeIndex];gsap.killTweensOf(e),gsap.killTweensOf(t);const s=e.getBoundingClientRect();gsap.set(e,{x:this.mouse.x-s.width/2,y:this.mouse.y-s.height/2,scale:0,opacity:1,zIndex:this.zIndex}),gsap.set(t,{scale:2.8,filter:"brightness(150%)"});gsap.timeline({onStart:()=>this.onImageActivate(),onComplete:()=>this.onImageComplete()}).to(e,{duration:.4,ease:"power1.out",scale:1},0).to(t,{duration:.6,ease:"power1.out",scale:1,filter:"brightness(100%)"},0).to(e,{duration:.4,ease:"power2.in",opacity:0,scale:.2},.45)}hideAllImages(){this.images.forEach((e=>{gsap.killTweensOf(e),gsap.set(e,{opacity:0,scale:.2})})),this.activeImagesCount=0,this.isIdle=!0,this.zIndex=1}onImageActivate(){this.activeImagesCount++}onImageComplete(){this.activeImagesCount--,0===this.activeImagesCount&&(this.isIdle=!0)}}class AgencyTrailManager{constructor(){this.agencyTrails=[],this.init()}init(){document.querySelectorAll(".agency").forEach((e=>{if(e.querySelector(".content")){const t=new AgencyTrail(e);this.agencyTrails.push(t)}}))}}document.addEventListener("DOMContentLoaded",(()=>{new AgencyTrailManager}));